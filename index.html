<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>結婚生活タイプ診断（7軸128タイプ）</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg: #f9fafb;
      --card: #ffffff;
      --accent: #0f766e;
      --accent-soft: #ccfbf1;
      --accent-strong: #0f766e;
      --danger: #f97373;
      --text: #111827;
      --muted: #6b7280;
      --border: #e5e7eb;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        "Noto Sans JP", sans-serif;
      background: radial-gradient(circle at top, #ecfeff 0, #f9fafb 38%, #f9fafb 100%);
      color: var(--text);
    }
    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .title-block {
      text-align: center;
    }
    .title-block h1 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 800;
      letter-spacing: 0.05em;
      color: var(--accent-strong);
    }
    .title-block p {
      margin: 4px 0 0;
      font-size: 0.875rem;
      color: var(--muted);
    }
    main {
      flex: 1;
      display: flex;
      justify-content: center;
      padding: 8px 12px 32px;
    }
    .card {
      width: 100%;
      max-width: 720px;
      background: var(--card);
      border-radius: 20px;
      padding: 20px 18px 24px;
      box-shadow: 0 16px 40px rgba(15, 23, 42, 0.12);
    }
    @media (min-width: 768px) {
      header { padding: 20px 24px; }
      .card { padding: 24px 28px 28px; border-radius: 24px; }
      .title-block h1 { font-size: 1.9rem; }
      .title-block p { font-size: 0.95rem; }
    }

    .quiz-header {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 16px;
    }
    .quiz-header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      color: var(--muted);
    }
    .badge {
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid rgba(15, 118, 110, 0.15);
      background: rgba(240, 253, 250, 0.8);
      color: var(--accent-strong);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .progress {
      width: 100%;
      height: 8px;
      background: #e5e7eb;
      border-radius: 999px;
      overflow: hidden;
    }
    .progress-inner {
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, #14b8a6, #0f766e);
      width: 0%;
      transition: width 200ms ease-out;
    }

    .question-index {
      font-size: 0.8rem;
      color: var(--muted);
    }
    .question-text {
      margin-top: 12px;
      font-weight: 600;
      font-size: 1.05rem;
      text-align: center;
      line-height: 1.5;
      color: #111827;
    }
    .option-labels {
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
      font-size: 0.9rem;
      color: var(--muted);
    }
    .option-labels span {
      max-width: 46%;
    }

    .hearts-row {
      margin-top: 18px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
    }
    .heart-btn {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 120ms ease-out, box-shadow 120ms, background 120ms;
      background: #f9fafb;
      box-shadow: 0 0 0 1px #e5e7eb;
      font-size: 20px;
      position: relative;
    }
    .heart-btn[data-side="A"] { color: #fb7185; }
    .heart-btn[data-side="B"] { color: #0f766e; }
    .heart-btn:hover {
      transform: translateY(-1px) scale(1.05);
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.12);
      background: #fefce8;
    }
    .heart-btn.selected {
      transform: translateY(-1px) scale(1.08);
      background: #fef9c3;
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.16);
    }
    .heart-btn.medium {
      width: 36px;
      height: 36px;
      font-size: 16px;
    }
    .heart-btn.small {
      width: 32px;
      height: 32px;
      font-size: 16px;
    }

    .scale-labels {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      color: var(--muted);
      padding: 0 6px;
    }

    .nav-row {
      margin-top: 24px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }
    .btn {
      border-radius: 999px;
      border: none;
      font-size: 0.9rem;
      padding: 10px 18px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      transition: background 120ms, transform 80ms, box-shadow 120ms, color 120ms;
      white-space: nowrap;
    }
    .btn-primary {
      background: #0f766e;
      color: white;
      box-shadow: 0 8px 18px rgba(15, 118, 110, 0.35);
    }
    .btn-primary:hover {
      background: #115e59;
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(15, 118, 110, 0.4);
    }
    .btn-primary:disabled {
      opacity: 0.4;
      cursor: default;
      box-shadow: none;
      transform: none;
    }
    .btn-ghost {
      background: transparent;
      color: var(--muted);
      border: 1px solid #e5e7eb;
    }
    .btn-ghost:hover {
      background: #f3f4f6;
      color: #374151;
    }

    /* Result styles */
    .result-header {
      text-align: center;
      margin-bottom: 16px;
    }
    .result-tag {
      font-size: 0.75rem;
      color: var(--accent-strong);
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(15, 118, 110, 0.15);
      background: rgba(240, 253, 250, 0.9);
      display: inline-block;
      margin-bottom: 6px;
    }
    .result-type-name {
      font-size: 1.3rem;
      font-weight: 800;
      margin: 4px 0 4px;
      color: #0f172a;
    }
    .result-code {
      font-size: 0.8rem;
      color: var(--muted);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      margin-top: 4px;
    }
    .result-catch {
      margin-top: 10px;
      font-size: 0.95rem;
      color: #4b5563;
    }
    .axis-chips {
      margin: 18px 0 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      justify-content: center;
    }
    .axis-chip {
      font-size: 0.75rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: #ecfeff;
      color: #0f766e;
      border: 1px solid rgba(14, 116, 144, 0.25);
    }
    .result-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 16px;
      font-size: 0.9rem;
    }
    @media (min-width: 768px) {
      .result-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    .result-section {
      border-radius: 14px;
      padding: 10px 12px;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
    }
    .result-section h3 {
      font-size: 0.85rem;
      font-weight: 700;
      margin: 0 0 4px;
      color: #374151;
    }
    .result-section p {
      margin: 0;
      color: #4b5563;
      line-height: 1.5;
    }
    .result-section ul {
      margin: 4px 0 0 1.1em;
      padding: 0;
      color: #4b5563;
    }
    .result-section li {
      margin-bottom: 2px;
    }
    .result-footer {
      margin-top: 18px;
      font-size: 0.8rem;
      color: var(--muted);
      text-align: center;
    }
    .result-image-wrap {
      margin-bottom: 8px;
      display: flex;
      justify-content: center;
    }
    .result-image {
      max-width: 120px;
      border-radius: 999px;
      box-shadow: 0 10px 25px rgba(15,23,42,0.25);
      background:#e5e7eb;
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="title-block">
        <h1>結婚生活タイプ診断（7軸128タイプ）</h1>
        <p>「生活・お金・食・役割・愛情表現」からあなたの結婚生活タイプを診断</p>
      </div>
    </header>
    <main>
      <div class="card">
        <!-- Quiz view -->
        <div id="quiz-view">
          <div class="quiz-header">
            <div class="quiz-header-top">
              <div class="badge">結婚生活タイプ診断</div>
              <div id="progress-text" class="question-index"></div>
            </div>
            <div class="progress"><div id="progress-bar" class="progress-inner"></div></div>
          </div>

          <div id="question-block">
            <div id="question-index-label" class="question-index"></div>
            <div id="question-text" class="question-text"></div>

            <div class="option-labels">
              <span id="label-a"></span>
              <span id="label-b" style="text-align:right"></span>
            </div>

            <div class="hearts-row" id="hearts-row"></div>

            <div class="scale-labels">
              <span>A寄り</span>
              <span>B寄り</span>
            </div>
          </div>

          <div class="nav-row">
            <button id="prev-btn" class="btn btn-ghost" type="button">
              ← 戻る
            </button>
            <button id="next-btn" class="btn btn-primary" type="button" disabled>
              次へ →
            </button>
          </div>
        </div>

        <!-- Result view -->
        <div id="result-view" style="display:none;">
          <div class="result-header">
            <div class="result-tag">診断結果</div>
            <div class="result-image-wrap">
              <!-- ここに将来イラストなどを紐づけてもOK（現状はプレースホルダ） -->
              <div class="result-image"></div>
            </div>
            <div id="result-type-name" class="result-type-name"></div>
            <div id="result-code" class="result-code"></div>
            <div id="result-catch" class="result-catch"></div>
          </div>

          <div id="axis-chips" class="axis-chips"></div>

          <div class="result-grid">
            <div class="result-section">
              <h3>結婚生活のスタイル</h3>
              <p id="result-life"></p>
            </div>
            <div class="result-section">
              <h3>パートナーとの関わり方</h3>
              <p id="result-partner"></p>
            </div>
            <div class="result-section">
              <h3>強み</h3>
              <ul id="result-strengths"></ul>
            </div>
            <div class="result-section">
              <h3>気をつけたいポイント</h3>
              <ul id="result-weaknesses"></ul>
            </div>
          </div>

          <div class="result-footer">
            タイプコード：<span id="result-code-inline"></span><br>
            <button id="copy-url-btn" class="btn btn-ghost" style="margin-top:8px;" type="button">
              診断結果のURLをコピーする
            </button><br>
            <button id="restart-btn" class="btn btn-ghost" style="margin-top:8px;" type="button">
              もう一度診断する
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // ===============================
    // 7軸定義（各軸2値 → 2^7 = 128タイプ）
    // ===============================

    // 軸のベース定義（コード・ラベル・説明・強み・弱みなど）
    const AXIS_DEFS = [
      {
        key: "LS", // LifeStyle
        name: "生活設計スタイル",
        sideA: {
          code: "H",
          label: "H：ホーム志向",
          chip: "ホーム志向（家・安定・インドア寄り）",
          tag: "家庭的で落ち着いた生活",
          lifeDesc: "家で過ごす時間を大切にし、落ち着いた日常や安定を重視するタイプです。",
          partnerDesc: "パートナーとは家でのんびり過ごす時間や、ルーティンの共有を大切にします。",
          strengths: [
            "日常生活が安定しやすく、家庭の土台を整えやすい",
            "家での時間を工夫して楽しむことができる",
            "一貫した生活リズムを作りやすい"
          ],
          weaknesses: [
            "変化や新しいチャレンジに慎重になりすぎることがある",
            "外出好きなパートナーとはペースがずれやすい"
          ]
        },
        sideB: {
          code: "A",
          label: "A：アドベンチャー志向",
          chip: "アドベンチャー志向（外出・刺激・変化寄り）",
          tag: "刺激と経験を求める生活",
          lifeDesc: "新しい場所や体験が好きで、日常の中にも変化や刺激を求めるタイプです。",
          partnerDesc: "パートナーとは一緒にお出かけしたり、イベントや旅行を楽しみたいスタイルです。",
          strengths: [
            "マンネリになりにくく、楽しい思い出を多く作れる",
            "新しい価値観や経験にも柔軟に適応できる"
          ],
          weaknesses: [
            "予定が詰まりすぎると家事や休息が後回しになりやすい",
            "インドア派のパートナーには少し忙しすぎると感じられることもある"
          ]
        }
      },
      {
        key: "MO", // Money
        name: "金銭管理スタイル",
        sideA: {
          code: "S",
          label: "S：セイバー（堅実）",
          chip: "セイバー（貯蓄・安定重視）",
          tag: "家計を守る堅実派",
          lifeDesc: "将来を見据えて、貯蓄や安定を意識したお金の使い方をするタイプです。",
          partnerDesc: "パートナーとの家計は計画的に管理し、必要なところにしっかりお金を回したいと考えます。",
          strengths: [
            "無理のない家計運営ができ、貯蓄もコツコツ積み上げられる",
            "大きな浪費やリスクの高い出費を避けやすい"
          ],
          weaknesses: [
            "楽しみのための出費に罪悪感を持ちやすい",
            "お金に対して慎重すぎると、経験や思い出の機会を逃すことも"
          ]
        },
        sideB: {
          code: "P",
          label: "P：プレイヤー（経験重視）",
          chip: "プレイヤー（経験・投資重視）",
          tag: "経験と投資を楽しむ派",
          lifeDesc: "お金は経験や成長、楽しみのために使っていきたいと考えるタイプです。",
          partnerDesc: "パートナーとは旅行や外食、自己投資など、人生を豊かにする使い方を共有したいスタイルです。",
          strengths: [
            "お金を通じて人生の満足度を上げるのが得意",
            "投資や成長に向けた使い方ができる"
          ],
          weaknesses: [
            "計画を立てないと、気づいたときに貯蓄が不足していることも",
            "堅実派のパートナーからは「ちょっと使いすぎ」と見られやすい"
          ]
        }
      },
      {
        key: "FO", // Food
        name: "食生活スタイル",
        sideA: {
          code: "G",
          label: "G：グルメ志向",
          chip: "グルメ志向（食の楽しみ重視）",
          tag: "食を楽しむグルメ派",
          lifeDesc: "おいしいものや外食、新しいお店の開拓など、食を“楽しみ”として大切にするタイプです。",
          partnerDesc: "パートナーとは一緒に食事を楽しみ、ちょっとした外食や記念日のご飯にこだわりたいと考えます。",
          strengths: [
            "日常の中で「食」を通じた楽しみを生み出せる",
            "記念日やイベントで印象的な思い出を作りやすい"
          ],
          weaknesses: [
            "外食や食費がかさみやすい",
            "食にこだわりの少ないパートナーとは温度差が出ることも"
          ]
        },
        sideB: {
          code: "L",
          label: "L：ライト志向（シンプル）",
          chip: "ライト志向（コスパ・シンプル重視）",
          tag: "シンプルで無理のない食生活",
          lifeDesc: "栄養やコスパ、手軽さを大事にし、食に過度なこだわりを持たないタイプです。",
          partnerDesc: "パートナーとは無理のない範囲で自炊や外食を組み合わせ、背伸びしない食生活を送りたいと考えます。",
          strengths: [
            "食費をコントロールしやすく、家計とも両立しやすい",
            "日々のご飯を“ちゃんと”回すことが得意"
          ],
          weaknesses: [
            "グルメなパートナーには物足りなく感じられることも",
            "食を通じたイベント感やサプライズはやや少なめになりがち"
          ]
        }
      },
      {
        key: "RO", // Role
        name: "役割分担意識",
        sideA: {
          code: "L",
          label: "L：リード型",
          chip: "リード型（決める・仕切る）",
          tag: "家庭を引っ張るリーダー気質",
          lifeDesc: "物事を決めたり、段取りを組んだりするのが得意で、自分から動いていくタイプです。",
          partnerDesc: "パートナーとの生活でも、方針決めや予定調整などを率先して引き受けることが多くなりがちです。",
          strengths: [
            "家事分担や生活の仕組みづくりを主導できる",
            "迷いがちな場面でも方針を示しやすい"
          ],
          weaknesses: [
            "自分のやり方を押し付けてしまうリスクがある",
            "頼られすぎて、気づくと負担が偏っていることも"
          ]
        },
        sideB: {
          code: "F",
          label: "F：フロー型",
          chip: "フロー型（合わせる・支える）",
          tag: "相手に合わせる協調タイプ",
          lifeDesc: "自分だけで決めるよりも、相手や状況に合わせて柔軟に動くタイプです。",
          partnerDesc: "パートナーの方針やペースを尊重しつつ、自分のできる形で支えていきたいと考えます。",
          strengths: [
            "相手の意見をよく聞き、柔軟に調整できる",
            "衝突を避けつつ、穏やかな関係を作りやすい"
          ],
          weaknesses: [
            "言わないうちに我慢がたまりやすい",
            "パートナーが受け身の場合、物事が進みにくいことも"
          ]
        }
      },
      {
        key: "LX", // Love eXpression
        name: "愛情表現スタイル",
        sideA: {
          code: "N",
          label: "N： nurture型（行動・時間）",
          chip: " nurture型（行動・時間で示す）",
          tag: "一緒に過ごす・世話をする愛情",
          lifeDesc: "一緒にいる時間や家事・サポートなど、行動で愛情を示すタイプです。",
          partnerDesc: "パートナーのために何かをしてあげることや、そばにいる時間を増やすことで愛情を表現します。",
          strengths: [
            "具体的な行動で支えるので、日常の安心感につながる",
            "“一緒にいる”ことで関係を育てるのが得意"
          ],
          weaknesses: [
            "言葉で気持ちを伝えるのが後回しになりがち",
            "自分がどれだけ頑張っているか相手に気づかれにくいことも"
          ]
        },
        sideB: {
          code: "V",
          label: "V： verbal型（言葉・気遣い）",
          chip: " verbal型（言葉・メッセージで示す）",
          tag: "言葉と気遣いで伝える愛情",
          lifeDesc: "「ありがとう」「好きだよ」など、言葉やメッセージで気持ちを伝えることを大切にするタイプです。",
          partnerDesc: "パートナーの気持ちを言葉で受け取り、自分の気持ちも丁寧に言葉で返したいと考えます。",
          strengths: [
            "気持ちのズレを言葉で埋められる",
            "相手にとって分かりやすい形で愛情を伝えられる"
          ],
          weaknesses: [
            "行動面が伴わないと“口だけ”に見られてしまうことも",
            "言葉でのやりとりに慣れていない相手とは温度差が出やすい"
          ]
        }
      },
      {
        key: "EC", // Emotion Communication
        name: "感情コミュニケーション",
        sideA: {
          code: "E",
          label: "E：エクスプレス型",
          chip: "エクスプレス型（感情を共有する）",
          tag: "感情を一緒に味わいたいタイプ",
          lifeDesc: "うれしい・悲しい・モヤモヤなどを、言葉や表情で比較的オープンに伝えるタイプです。",
          partnerDesc: "パートナーにも本音や気持ちを聞きたいし、自分の気持ちもその都度シェアしていきたいと考えます。",
          strengths: [
            "気持ちを溜め込みにくく、誤解を減らしやすい",
            "パートナーと感情レベルでつながりやすい"
          ],
          weaknesses: [
            "その場の感情で話しすぎてしまうことがある",
            "感情表現が少ない相手には“重い”と感じられることも"
          ]
        },
        sideB: {
          code: "C",
          label: "C：カーム型",
          chip: "カーム型（内側で整理する）",
          tag: "一度飲み込んでから伝えるタイプ",
          lifeDesc: "感情をまず自分の中で整理してから、必要に応じて言葉にするタイプです。",
          partnerDesc: "パートナーには、落ち着いてから気持ちを伝えたいと考え、衝突よりも安定を優先します。",
          strengths: [
            "感情的になりすぎず、落ち着いたコミュニケーションができる",
            "冷静に状況を見てから話し合いができる"
          ],
          weaknesses: [
            "何を考えているか分かりづらいと感じられることがある",
            "気持ちを飲み込んだまま、タイミングを逃してしまうことも"
          ]
        }
      },
      {
        key: "CF", // ConFlict handling
        name: "衝突時スタイル",
        sideA: {
          code: "D",
          label: "D：ダイレクト型",
          chip: "ダイレクト型（その場で話し合う）",
          tag: "問題を正面から扱いたいタイプ",
          lifeDesc: "モヤモヤや問題があれば、その場で話し合って整理したいタイプです。",
          partnerDesc: "パートナーとも率直に話し合い、納得感のある形で解決したいと考えます。",
          strengths: [
            "問題を先送りせず、早めに対処できる",
            "誤解やすれ違いをその場で修正しやすい"
          ],
          weaknesses: [
            "相手の心の準備ができていないと圧を感じさせてしまうことがある",
            "感情が高ぶっているときは言いすぎてしまうリスクも"
          ]
        },
        sideB: {
          code: "H",
          label: "H：ハーモニー型",
          chip: "ハーモニー型（衝突を和らげる）",
          tag: "衝突を最小限にしたいタイプ",
          lifeDesc: "空気が悪くなることを避けたい気持ちが強く、ぶつかるよりも時間を置いたり、やわらかく処理したいタイプです。",
          partnerDesc: "パートナーとの関係では、必要な話し合いはしつつも、お互いが傷つきすぎない形を探したいと考えます。",
          strengths: [
            "関係の雰囲気を壊しすぎずに保ちやすい",
            "相手の立場や気持ちに配慮した対応ができる"
          ],
          weaknesses: [
            "問題を先延ばしにしてしまうことがある",
            "言わないまま我慢が積もると、ある日一気に噴き出すリスクも"
          ]
        }
      }
    ];

    // 質問定義
    // axisKey: AXIS_DEFS.key を参照, direction: +1 = A側がプラス, -1 = B側がプラス
    const QUESTIONS = [
      // 生活設計 LS
      {
        id: 1,
        axis: "LS",
        direction: +1,
        text: "休日の過ごし方として、どちらがよりしっくりきますか？",
        aLabel: "A. 家でゆっくり過ごしたり、近場でのんびりすることが多い",
        bLabel: "B. 外出やイベント・旅行など、新しい刺激を求めがち"
      },
      {
        id: 2,
        axis: "LS",
        direction: +1,
        text: "1週間の理想のスケジュール感は？",
        aLabel: "A. ある程度決まったリズムで、毎日を安定して過ごしたい",
        bLabel: "B. 週によって予定がガラッと変わるくらいがちょうどいい"
      },
      {
        id: 3,
        axis: "LS",
        direction: -1,
        text: "長期休暇のイメージとして近いのは？",
        aLabel: "A. 行き先を決めず、気分で動いたり遠出したい",
        bLabel: "B. 家でのんびりしつつ、近場で少し出かけるくらいが良い"
      },
      {
        id: 4,
        axis: "LS",
        direction: +1,
        text: "結婚後の理想の暮らしに近いのは？",
        aLabel: "A. 落ち着いたエリアで、家中心の生活を安定させたい",
        bLabel: "B. 立地や環境を変えながら、その時々を楽しみたい"
      },

      // 金銭 MO
      {
        id: 5,
        axis: "MO",
        direction: +1,
        text: "お金の優先順位として、どちらが近いですか？",
        aLabel: "A. まずは貯蓄や将来の安心を確保したい",
        bLabel: "B. 今の経験や楽しみのためにも積極的に使いたい"
      },
      {
        id: 6,
        axis: "MO",
        direction: -1,
        text: "ボーナスの使い方で、より自分らしいのは？",
        aLabel: "A. 欲しいものや旅行などに思い切って使いたい",
        bLabel: "B. まとまった額を貯金や投資に回しておきたい"
      },
      {
        id: 7,
        axis: "MO",
        direction: +1,
        text: "結婚後の家計イメージとして近いのは？",
        aLabel: "A. 基本は堅実に管理しつつ、余裕が出たら楽しむ",
        bLabel: "B. 人生の満足度を上げるために、ある程度積極的に使う"
      },
      {
        id: 8,
        axis: "MO",
        direction: -1,
        text: "カード明細を見たときの感覚として近いのは？",
        aLabel: "A. 「まあなんとかなるか」と思うことが多い",
        bLabel: "B. 「来月は少し抑えよう」と管理意識が働きやすい"
      },

      // 食 FO
      {
        id: 9,
        axis: "FO",
        direction: +1,
        text: "食事に対する感覚として近いのは？",
        aLabel: "A. おいしさやお店選びなど、食そのものを楽しみたい",
        bLabel: "B. おいしかったら十分で、そこまでこだわりは強くない"
      },
      {
        id: 10,
        axis: "FO",
        direction: +1,
        text: "外食について、どちらがしっくりきますか？",
        aLabel: "A. 気になるお店や話題の店にはぜひ行きたい",
        bLabel: "B. たまに行ければ十分で、普段はシンプルで良い"
      },
      {
        id: 11,
        axis: "FO",
        direction: -1,
        text: "自炊に対するイメージとして、近いのは？",
        aLabel: "A. 手間をかけるより、簡単に済ませたいことが多い",
        bLabel: "B. 栄養バランスやコスパも意識しつつ、無理のない範囲で作りたい"
      },
      {
        id: 12,
        axis: "FO",
        direction: +1,
        text: "パートナーと食の価値観を合わせるとしたら？",
        aLabel: "A. 少し無理してでも「おいしい体験」を一緒にしたい",
        bLabel: "B. 背伸びしない範囲で、無理のない食生活を一緒に作りたい"
      },

      // 役割 RO
      {
        id: 13,
        axis: "RO",
        direction: +1,
        text: "家事や予定決めに関して、どちらが近いですか？",
        aLabel: "A. 自分が段取りして進める方がラクだと感じる",
        bLabel: "B. 相手と相談しながら決めていきたい"
      },
      {
        id: 14,
        axis: "RO",
        direction: +1,
        text: "職場やグループでの自分の立ち位置に近いのは？",
        aLabel: "A. 気づいたらまとめ役や調整役になることが多い",
        bLabel: "B. 誰かが決めた方針に合わせて動くことが多い"
      },
      {
        id: 15,
        axis: "RO",
        direction: -1,
        text: "結婚生活の中での役割イメージは？",
        aLabel: "A. できれば相手に主導してほしい場面が多い",
        bLabel: "B. 自分も一緒に考えて、必要なら主導もできる方が良い"
      },
      {
        id: 16,
        axis: "RO",
        direction: +1,
        text: "「決断」の場面で、どちらに近いですか？",
        aLabel: "A. 最終的には自分が決めた方がスッキリする",
        bLabel: "B. 話し合って決める方が安心感がある"
      },

      // 愛情 LX
      {
        id: 17,
        axis: "LX",
        direction: +1,
        text: "パートナーに「愛情を伝えたい」と思ったとき、まずイメージするのは？",
        aLabel: "A. 一緒に過ごす時間を増やしたり、何かしてあげること",
        bLabel: "B. メッセージや言葉で気持ちを伝えること"
      },
      {
        id: 18,
        axis: "LX",
        direction: +1,
        text: "相手からの愛情表現として、一番うれしいのは？",
        aLabel: "A. 手伝ってくれる・気にかけて行動してくれる",
        bLabel: "B. 「ありがとう」「好きだよ」など、言葉で伝えてくれる"
      },
      {
        id: 19,
        axis: "LX",
        direction: -1,
        text: "日常の連絡スタイルとして近いのは？",
        aLabel: "A. 用事があるときに連絡すればいいと思うことが多い",
        bLabel: "B. 特に用事がなくても、ひと言でもやりとりしたい"
      },
      {
        id: 20,
        axis: "LX",
        direction: +1,
        text: "記念日や特別な日のイメージは？",
        aLabel: "A. 手料理や一緒に過ごす時間など、行動で特別にしたい",
        bLabel: "B. メッセージカードや言葉で気持ちを伝える時間を大事にしたい"
      },

      // 感情 EC
      {
        id: 21,
        axis: "EC",
        direction: +1,
        text: "日常の中で、うれしい・悲しい・ムッとしたなどの感情は…",
        aLabel: "A. わりとすぐ顔や言葉に出る方だと思う",
        bLabel: "B. まず自分の中で整理してから出てくることが多い"
      },
      {
        id: 22,
        axis: "EC",
        direction: -1,
        text: "落ち込んだときの過ごし方として近いのは？",
        aLabel: "A. ひとまず一人で考えたり、静かにしていたい",
        bLabel: "B. 誰かに話してスッキリしたい"
      },
      {
        id: 23,
        axis: "EC",
        direction: +1,
        text: "パートナーとの会話イメージは？",
        aLabel: "A. その日のことや気持ちを、ある程度シェアしたい",
        bLabel: "B. 必要なことや本当に伝えたいときだけ話せればよい"
      },
      {
        id: 24,
        axis: "EC",
        direction: +1,
        text: "感情のリアクションとして近いのは？",
        aLabel: "A. 笑ったり驚いたり、リアクションが大きい方だと思う",
        bLabel: "B. 落ち着いていて、あまりオーバーリアクションはしない"
      },

      // 衝突 CF
      {
        id: 25,
        axis: "CF",
        direction: +1,
        text: "パートナーとの間でモヤモヤを感じたとき、どちらが多いですか？",
        aLabel: "A. できるだけ早めに話しておきたい",
        bLabel: "B. しばらく様子を見て、落ち着いてから考えたい"
      },
      {
        id: 26,
        axis: "CF",
        direction: +1,
        text: "ケンカや衝突について、どちらの考えが近いですか？",
        aLabel: "A. ぶつかってもいいから話し合った方がスッキリする",
        bLabel: "B. なるべく大きな衝突は避けたい"
      },
      {
        id: 27,
        axis: "CF",
        direction: -1,
        text: "相手が怒っていそうなとき、あなたは？",
        aLabel: "A. とりあえずそっとしておき、タイミングを見たい",
        bLabel: "B. 状況を確認して、話せるなら早めに話したい"
      },
      {
        id: 28,
        axis: "CF",
        direction: +1,
        text: "「ごめんね」を伝えるタイミングとして近いのは？",
        aLabel: "A. 気づいたらすぐに伝えたい方だ",
        bLabel: "B. 相手が落ち着いてから、タイミングを見て伝えたい"
      }
    ];

    // 6段階ハート（A強〜B強、ど真ん中なし）
    // index: 0〜5 => [-3, -2, -1, +1, +2, +3]
    const HEART_VALUES = [-3, -2, -1, 1, 2, 3];

    // ===============================
    // 状態管理
    // ===============================
    let currentIndex = 0; // 0-based
    const answers = {};   // questionId -> 0〜5（ハートindex）

    const quizView = document.getElementById("quiz-view");
    const resultView = document.getElementById("result-view");

    const progressTextEl = document.getElementById("progress-text");
    const progressBarEl = document.getElementById("progress-bar");
    const qIndexLabelEl = document.getElementById("question-index-label");
    const qTextEl = document.getElementById("question-text");
    const labelAEl = document.getElementById("label-a");
    const labelBEl = document.getElementById("label-b");
    const heartsRowEl = document.getElementById("hearts-row");
    const prevBtn = document.getElementById("prev-btn");
    const nextBtn = document.getElementById("next-btn");

    const resultTypeNameEl = document.getElementById("result-type-name");
    const resultCodeEl = document.getElementById("result-code");
    const resultCodeInlineEl = document.getElementById("result-code-inline");
    const resultCatchEl = document.getElementById("result-catch");
    const resultLifeEl = document.getElementById("result-life");
    const resultPartnerEl = document.getElementById("result-partner");
    const resultStrengthsEl = document.getElementById("result-strengths");
    const resultWeaknessesEl = document.getElementById("result-weaknesses");
    const axisChipsEl = document.getElementById("axis-chips");
    const restartBtn = document.getElementById("restart-btn");
    const copyUrlBtn = document.getElementById("copy-url-btn");

    // ===============================
    // 質問画面描画
    // ===============================
    function renderQuestion() {
      const total = QUESTIONS.length;
      const q = QUESTIONS[currentIndex];
      const answeredIndex = answers[q.id];

      progressTextEl.textContent = `質問 ${currentIndex + 1} / ${total}`;
      const progressPercent = (currentIndex / total) * 100;
      progressBarEl.style.width = `${progressPercent}%`;

      qIndexLabelEl.textContent = `Q${String(currentIndex + 1).padStart(2, "0")}`;
      qTextEl.textContent = q.text;
      labelAEl.textContent = q.aLabel;
      labelBEl.textContent = q.bLabel;

      heartsRowEl.innerHTML = "";
      for (let i = 0; i < 6; i++) {
        const btn = document.createElement("button");
        const side = i < 3 ? "A" : "B";
        let sizeClass = "";
        if (i === 1 || i === 4) sizeClass = " medium";
        if (i === 2 || i === 3) sizeClass = " small";

        btn.className = "heart-btn" + sizeClass;
        btn.dataset.value = String(i);
        btn.dataset.side = side;
        btn.innerHTML = "❤";

        if (answeredIndex === i) {
          btn.classList.add("selected");
        }
        btn.addEventListener("click", () => {
          answers[q.id] = i;
          renderQuestion();
        });
        heartsRowEl.appendChild(btn);
      }

      prevBtn.disabled = currentIndex === 0;
      nextBtn.disabled = answers[q.id] == null;
      if (currentIndex === total - 1) {
        nextBtn.textContent = "結果を見る →";
      } else {
        nextBtn.textContent = "次へ →";
      }
    }

    function clearUrlType() {
      const url = new URL(window.location.href);
      url.searchParams.delete("type");
      history.replaceState(null, "", url.toString());
    }

    function resetQuiz() {
      clearUrlType();
      Object.keys(answers).forEach(key => delete answers[key]);
      currentIndex = 0;
      quizView.style.display = "";
      resultView.style.display = "none";
      renderQuestion();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // ===============================
    // 結果ロジック（軸ごとに合算 → 7文字コード → テキスト自動生成）
    // ===============================
    function calculateResult() {
      // 軸スコア初期化
      const axisScores = {};
      AXIS_DEFS.forEach(a => {
        axisScores[a.key] = 0;
      });

      // 質問ごとの回答をスコアに加算
      for (const q of QUESTIONS) {
        const idx = answers[q.id];
        if (idx == null) continue;
        const base = HEART_VALUES[idx]; // -3〜+3
        axisScores[q.axis] += base * q.direction;
      }

      // 各軸のA/Bどちらかを決定
      const chosenSides = []; // {axisDef, side}
      const codeLetters = [];

      for (const axisDef of AXIS_DEFS) {
        const score = axisScores[axisDef.key] || 0;
        const side = score >= 0 ? axisDef.sideA : axisDef.sideB;
        chosenSides.push({ axis: axisDef, side });
        codeLetters.push(side.code);
      }

      const code = codeLetters.join("");

      renderResultByAxes(code, chosenSides);
    }

    function updateUrlWithCode(code) {
      const url = new URL(window.location.href);
      url.searchParams.set("type", code);
      history.replaceState(null, "", url.toString());
    }

    function renderResultByAxes(code, chosenSides) {
      updateUrlWithCode(code);

      quizView.style.display = "none";
      resultView.style.display = "";

      // タイプ名：上位3軸のタグを×で連結
      const mainTags = chosenSides.slice(0, 3).map(cs => cs.side.tag);
      const typeName = mainTags.join(" × ") + "タイプ";

      resultTypeNameEl.textContent = typeName;
      resultCodeEl.textContent = code;
      resultCodeInlineEl.textContent = code;

      // キャッチコピー：生活系（LS/MO/FO）と感情・コミュ系（LX/EC/CF）からざっくり合成
      const lifeRelated = ["LS", "MO", "FO"];
      const commRelated = ["LX", "EC", "CF", "RO"];
      const lifePhrase = chosenSides
        .filter(cs => lifeRelated.includes(cs.axis.key))
        .map(cs => cs.side.tag)
        .join("・");
      const commPhrase = chosenSides
        .filter(cs => commRelated.includes(cs.axis.key))
        .map(cs => cs.side.tag)
        .join("・");

      const catchText =
        `「${lifePhrase}」と「${commPhrase}」をあわせ持つ、結婚生活で個性がはっきりしたタイプです。`;
      resultCatchEl.textContent = catchText;

      // 軸チップ表示
      axisChipsEl.innerHTML = "";
      chosenSides.forEach(cs => {
        const chip = document.createElement("span");
        chip.className = "axis-chip";
        chip.textContent = `${cs.axis.name}：${cs.side.label}`;
        axisChipsEl.appendChild(chip);
      });

      // 結婚生活のスタイル（lifeDescriptionを合成）
      const lifeSentences = chosenSides
        .filter(cs => ["LS", "MO", "FO"].includes(cs.axis.key))
        .map(cs => cs.side.lifeDesc);
      resultLifeEl.textContent = lifeSentences.join(" ");

      // パートナーとの関わり方（partnerDescを合成）
      const partnerSentences = chosenSides
        .filter(cs => ["RO", "LX", "EC", "CF"].includes(cs.axis.key))
        .map(cs => cs.side.partnerDesc);
      resultPartnerEl.textContent = partnerSentences.join(" ");

      // 強み・弱み（各軸の強み/弱みを合成し、最大6件ずつ表示）
      const strengths = [];
      const weaknesses = [];
      chosenSides.forEach(cs => {
        strengths.push(...(cs.side.strengths || []));
        weaknesses.push(...(cs.side.weaknesses || []));
      });

      resultStrengthsEl.innerHTML = "";
      strengths.slice(0, 6).forEach(s => {
        const li = document.createElement("li");
        li.textContent = s;
        resultStrengthsEl.appendChild(li);
      });

      resultWeaknessesEl.innerHTML = "";
      weaknesses.slice(0, 6).forEach(w => {
        const li = document.createElement("li");
        li.textContent = w;
        resultWeaknessesEl.appendChild(li);
      });

      window.scrollTo({
        top: resultView.offsetTop - 24,
        behavior: "smooth"
      });
    }

    // ===============================
    // イベントハンドラ
    // ===============================
    prevBtn.addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        renderQuestion();
      }
    });

    nextBtn.addEventListener("click", () => {
      const total = QUESTIONS.length;
      if (currentIndex < total - 1) {
        currentIndex++;
        renderQuestion();
      } else {
        // 全問回答チェック
        for (const q of QUESTIONS) {
          if (answers[q.id] == null) {
            alert("すべての質問に回答してください。");
            return;
          }
        }
        calculateResult();
      }
    });

    restartBtn.addEventListener("click", resetQuiz);

    copyUrlBtn.addEventListener("click", () => {
      const url = new URL(window.location.href);
      const currentCode = resultCodeEl.textContent.trim();
      if (currentCode && !url.searchParams.get("type")) {
        url.searchParams.set("type", currentCode);
      }
      const shareUrl = url.toString();

      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(shareUrl)
          .then(() => {
            alert("この診断結果のURLをコピーしました。");
          })
          .catch(() => {
            alert("URLのコピーに失敗しました。手動でコピーしてください。");
          });
      } else {
        window.prompt("このURLをコピーしてください。", shareUrl);
      }
    });

    // ===============================
    // 初期表示 & 共有URLからの復元
    // ===============================
    function initFromUrl() {
      const params = new URLSearchParams(window.location.search);
      const presetCode = params.get("type");
      if (!presetCode) {
        renderQuestion();
        return;
      }

      // URLに type=XXXXXXX があれば、7文字として各軸に割り当てて再現
      if (presetCode.length !== AXIS_DEFS.length) {
        renderQuestion();
        return;
      }

      const chosenSides = [];
      for (let i = 0; i < AXIS_DEFS.length; i++) {
        const axisDef = AXIS_DEFS[i];
        const letter = presetCode[i];
        let side;
        if (axisDef.sideA.code === letter) {
          side = axisDef.sideA;
        } else if (axisDef.sideB.code === letter) {
          side = axisDef.sideB;
        } else {
          // 不明なコードの場合は中断して通常表示
          renderQuestion();
          return;
        }
        chosenSides.push({ axis: axisDef, side });
      }
      renderResultByAxes(presetCode, chosenSides);
    }

    initFromUrl();
  </script>
</body>
</html>
