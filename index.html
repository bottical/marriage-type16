<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>婚活16タイプ診断（4軸）</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg: #f9fafb;
      --card: #ffffff;
      --accent: #0f766e;
      --accent-soft: #ccfbf1;
      --accent-strong: #0f766e;
      --danger: #f97373;
      --text: #111827;
      --muted: #6b7280;
      --border: #e5e7eb;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        "Noto Sans JP", sans-serif;
      background: radial-gradient(circle at top, #ecfeff 0, #f9fafb 38%, #f9fafb 100%);
      color: var(--text);
    }
    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .title-block {
      text-align: center;
    }
    .title-block h1 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 800;
      letter-spacing: 0.05em;
      color: var(--accent-strong);
    }
    .title-block p {
      margin: 4px 0 0;
      font-size: 0.875rem;
      color: var(--muted);
    }
    main {
      flex: 1;
      display: flex;
      justify-content: center;
      padding: 8px 12px 32px;
    }
    .card {
      width: 100%;
      max-width: 720px;
      background: var(--card);
      border-radius: 20px;
      padding: 20px 18px 24px;
      box-shadow: 0 16px 40px rgba(15, 23, 42, 0.12);
    }
    @media (min-width: 768px) {
      header { padding: 20px 24px; }
      .card { padding: 24px 28px 28px; border-radius: 24px; }
      .title-block h1 { font-size: 1.9rem; }
      .title-block p { font-size: 0.95rem; }
    }

    .quiz-header {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 16px;
    }
    .quiz-header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      color: var(--muted);
    }
    .badge {
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid rgba(15, 118, 110, 0.15);
      background: rgba(240, 253, 250, 0.8);
      color: var(--accent-strong);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .progress {
      width: 100%;
      height: 8px;
      background: #e5e7eb;
      border-radius: 999px;
      overflow: hidden;
    }
    .progress-inner {
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, #14b8a6, #0f766e);
      width: 0%;
      transition: width 200ms ease-out;
    }

    .question-index {
      font-size: 0.8rem;
      color: var(--muted);
    }
    .question-text {
      margin-top: 12px;
      font-weight: 600;
      font-size: 1.05rem;
      text-align: center;
      line-height: 1.5;
      color: #111827;
    }
    .option-labels {
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
      font-size: 0.9rem;
      color: var(--muted);
    }
    .option-labels span {
      max-width: 46%;
    }

    .hearts-row {
      margin-top: 18px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
    }
    .heart-btn {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 120ms ease-out, box-shadow 120ms, background 120ms;
      background: #f9fafb;
      box-shadow: 0 0 0 1px #e5e7eb;
      font-size: 20px;
      position: relative;
    }
    .heart-btn[data-side="A"] { color: #fb7185; }
    .heart-btn[data-side="B"] { color: #0f766e; }
    .heart-btn:hover {
      transform: translateY(-1px) scale(1.05);
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.12);
      background: #fefce8;
    }
    .heart-btn.selected {
      transform: translateY(-1px) scale(1.08);
      background: #fef9c3;
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.16);
    }
    .heart-btn.medium {
      width: 36px;
      height: 36px;
      font-size: 16px;
    }
    .heart-btn.small {
      width: 32px;
      height: 32px;
      font-size: 16px;
    }

    .scale-labels {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      color: var(--muted);
      padding: 0 6px;
    }

    .nav-row {
      margin-top: 24px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }
    .btn {
      border-radius: 999px;
      border: none;
      font-size: 0.9rem;
      padding: 10px 18px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      transition: background 120ms, transform 80ms, box-shadow 120ms, color 120ms;
      white-space: nowrap;
    }
    .btn-primary {
      background: #0f766e;
      color: white;
      box-shadow: 0 8px 18px rgba(15, 118, 110, 0.35);
    }
    .btn-primary:hover {
      background: #115e59;
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(15, 118, 110, 0.4);
    }
    .btn-primary:disabled {
      opacity: 0.4;
      cursor: default;
      box-shadow: none;
      transform: none;
    }
    .btn-ghost {
      background: transparent;
      color: var(--muted);
      border: 1px solid #e5e7eb;
    }
    .btn-ghost:hover {
      background: #f3f4f6;
      color: #374151;
    }

    /* Result styles */
    .result-header {
      text-align: center;
      margin-bottom: 16px;
    }
    .result-tag {
      font-size: 0.75rem;
      color: var(--accent-strong);
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(15, 118, 110, 0.15);
      background: rgba(240, 253, 250, 0.9);
      display: inline-block;
      margin-bottom: 6px;
    }
    .result-type-name {
      font-size: 1.3rem;
      font-weight: 800;
      margin: 4px 0 4px;
      color: #0f172a;
    }
    .result-code {
      font-size: 0.8rem;
      color: var(--muted);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      margin-top: 4px;
    }
    .result-catch {
      margin-top: 10px;
      font-size: 0.95rem;
      color: #4b5563;
    }
    .axis-chips {
      margin: 18px 0 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      justify-content: center;
    }
    .axis-chip {
      font-size: 0.75rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: #ecfeff;
      color: #0f766e;
      border: 1px solid rgba(14, 116, 144, 0.25);
    }
    .result-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 16px;
      font-size: 0.9rem;
    }
    @media (min-width: 768px) {
      .result-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    .result-section {
      border-radius: 14px;
      padding: 10px 12px;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
    }
    .result-section h3 {
      font-size: 0.85rem;
      font-weight: 700;
      margin: 0 0 4px;
      color: #374151;
    }
    .result-section p {
      margin: 0;
      color: #4b5563;
      line-height: 1.5;
    }
    .result-section ul {
      margin: 4px 0 0 1.1em;
      padding: 0;
      color: #4b5563;
    }
    .result-section li {
      margin-bottom: 2px;
    }
    .result-footer {
      margin-top: 18px;
      font-size: 0.8rem;
      color: var(--muted);
      text-align: center;
    }
    .result-image-wrap {
      margin-bottom: 8px;
      display: flex;
      justify-content: center;
    }
    .result-image {
      max-width: 240px;
      height: 240px;
      border-radius: 999px;
      box-shadow: 0 10px 25px rgba(15,23,42,0.25);
      background:#ffdbed;
      object-fit: cover;
    }

    /* 全16タイプ一覧（共通） */
    .type-list-wrapper {
      margin-top: 22px;
      padding-top: 10px;
      border-top: 1px dashed #e5e7eb;
    }
    .type-list-heading {
      font-size: 0.95rem;
      margin: 0 0 4px;
      color: #111827;
      font-weight: 700;
    }
    .type-list-note {
      margin: 0 0 10px;
      font-size: 0.8rem;
      color: var(--muted);
    }
    .type-list-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
    }
    @media (min-width: 640px) {
      .type-list-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    @media (min-width: 900px) {
      .type-list-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    .type-list-item {
      width: 100%;
      text-align: left;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      padding: 8px 10px;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 2px;
      transition: background 120ms, box-shadow 120ms, transform 80ms, border-color 120ms;
    }
    .type-list-item:hover {
      background: #eef2ff;
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.08);
      transform: translateY(-1px);
      border-color: #c7d2fe;
    }
    .type-list-item.is-active {
      background: #ecfeff;
      border-color: #0f766e;
      box-shadow: 0 6px 16px rgba(15, 118, 110, 0.25);
    }
    .type-list-code {
      font-size: 0.75rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #6b7280;
    }
    .type-list-name {
      font-size: 0.9rem;
      font-weight: 700;
      color: #111827;
    }
    .type-list-catch {
      font-size: 0.8rem;
      color: #6b7280;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .type-list-item-content {
      display: flex;
      align-items: center;
      gap: 8px;
      overflow: hidden;
    }
    .type-list-thumb {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      object-fit: cover;
      flex-shrink: 0;
      background: #e5e7eb;
      box-shadow: 0 3px 8px rgba(15, 23, 42, 0.15);
    }
    .type-list-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
      text-align: left;
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="title-block">
        <h1>婚活16タイプ診断</h1>
        <p>生活・お金・愛情表現・話し合いスタイルから、あなたの結婚タイプを診断</p>
      </div>
    </header>
    <main>
      <div class="card">
        <!-- Quiz view -->
        <div id="quiz-view">
          <div class="quiz-header">
            <div class="quiz-header-top">
              <div class="badge">婚活版 16タイプ診断</div>
              <div id="progress-text" class="question-index"></div>
            </div>
            <div class="progress"><div id="progress-bar" class="progress-inner"></div></div>
          </div>

          <div id="question-block">
            <div id="question-index-label" class="question-index"></div>
            <div id="question-text" class="question-text"></div>

            <div class="option-labels">
              <span id="label-a"></span>
              <span id="label-b" style="text-align:right"></span>
            </div>

            <div class="hearts-row" id="hearts-row"></div>

            <div class="scale-labels">
              <span>A寄り</span>
              <span>B寄り</span>
            </div>
          </div>

          <div class="nav-row">
            <button id="prev-btn" class="btn btn-ghost" type="button">
              ← 戻る
            </button>
            <button id="next-btn" class="btn btn-primary" type="button" disabled>
              次へ →
            </button>
          </div>

          <!-- Quiz画面にも一覧を表示 -->
          <div class="type-list-wrapper">
            <h3 class="type-list-heading">全16タイプ一覧</h3>
            <p class="type-list-note">※タップするとタイプ名・キャッチコピーと詳細結果を確認できます</p>
            <div id="type-list-quiz" class="type-list-grid"></div>
          </div>
        </div>

        <!-- Result view -->
        <div id="result-view" style="display:none;">
          <div class="result-header">
            <div class="result-tag">診断結果</div>
            <div class="result-image-wrap">
              <!-- 画像パスは「images/types/コード.png」を想定（例：images/types/HSND.png） -->
              <img
                id="result-image"
                class="result-image"
                src="images/types/default.png"
                alt="タイプイメージ"
                loading="lazy"
              />
            </div>
            <div id="result-type-name" class="result-type-name"></div>
            <div id="result-code" class="result-code"></div>
            <div id="result-catch" class="result-catch"></div>
          </div>

          <div id="axis-chips" class="axis-chips"></div>

          <div class="result-grid">
            <div class="result-section">
              <h3>結婚生活のスタイル</h3>
              <p id="result-life"></p>
            </div>
            <div class="result-section">
              <h3>パートナーとの関わり方</h3>
              <p id="result-partner"></p>
            </div>
            <div class="result-section">
              <h3>強み</h3>
              <ul id="result-strengths"></ul>
            </div>
            <div class="result-section">
              <h3>気をつけたいポイント</h3>
              <ul id="result-weaknesses"></ul>
            </div>
          </div>

                    <div class="result-footer">
            タイプコード：<span id="result-code-inline"></span><br>
            <button id="copy-url-btn" class="btn btn-ghost" style="margin-top:8px;" type="button">
              診断結果のURLをコピーする
            </button><br>
            <!-- ここに128タイプ詳細版への導線を後から足せます -->
            <button id="restart-btn" class="btn btn-ghost" style="margin-top:8px;" type="button">
              もう一度診断する
            </button>
          </div>

          <!-- Result画面の16タイプ一覧 -->
          <div class="type-list-wrapper">
            <h3 class="type-list-heading">全16タイプ一覧</h3>
            <p class="type-list-note">※タップすると他のタイプの説明も確認できます</p>
            <div id="type-list-result" class="type-list-grid"></div>
          </div>

        </div>
      </div>
    </main>
  </div>

  <script>
    // ===============================
    // 4軸定義（16タイプ）
    // ===============================
    const AXES = [
      {
        key: "LS", // LifeStyle
        name: "生活スタイル",
        sideA: { code: "H", label: "H：ホーム志向（落ち着き重視）" },
        sideB: { code: "A", label: "A：アクティブ志向（外出・刺激重視）" }
      },
      {
        key: "MO", // Money
        name: "お金・家計スタイル",
        sideA: { code: "S", label: "S：セイバー（貯蓄・安定重視）" },
        sideB: { code: "P", label: "P：プレイヤー（経験・投資重視）" }
      },
      {
        key: "LX", // Love eXpression
        name: "愛情表現スタイル",
        sideA: { code: "N", label: "N： nurture型（行動・時間で示す）" },
        sideB: { code: "V", label: "V： verbal型（言葉・メッセージで示す）" }
      },
      {
        key: "CF", // ConFlict
        name: "話し合い・衝突スタイル",
        sideA: { code: "D", label: "D：ダイレクト型（その場で話す）" },
        sideB: { code: "R", label: "R：ラウンド型（衝突を和らげる・丸く収める）" }
      }
    ];

    // 6段階ハート：A寄り → 正の値、B寄り → 負の値
    // index: 0〜5 => A強, A中, A弱, B弱, B中, B強
    const HEART_VALUES = [3, 2, 1, -1, -2, -3];

    // ===============================
    // 質問定義
    // axis: 対象軸, direction: A寄りをその軸のどちら側に寄せるか（+1/-1）
    // ===============================
    const QUESTIONS = [
      // 生活スタイル LS (H vs A) : A=Home, B=Active
      {
        id: 1,
        axis: "LS",
        direction: +1,
        text: "休日の過ごし方として、どちらがよりしっくりきますか？",
        aLabel: "A. 家でゆっくり過ごしたり、近場でのんびりすることが多い",
        bLabel: "B. 外出やイベント・旅行など、新しい刺激を求めがち"
      },
      {
        id: 2,
        axis: "LS",
        direction: +1,
        text: "平日の仕事終わり、理想の過ごし方に近いのは？",
        aLabel: "A. なるべく早く帰って、家でゆったり過ごしたい",
        bLabel: "B. 予定が入っていたり、外で過ごす日がある方が楽しい"
      },
      {
        id: 3,
        axis: "LS",
        direction: +1,
        text: "長期休暇のイメージとして近いのは？",
        aLabel: "A. 家や近場で、ゆっくり休みながら過ごしたい",
        bLabel: "B. せっかくなら遠出や旅行など、普段できないことをしたい"
      },
      {
        id: 4,
        axis: "LS",
        direction: +1,
        text: "結婚後の理想の暮らしに近いのは？",
        aLabel: "A. 落ち着いたエリアで、家中心の生活を安定させたい",
        bLabel: "B. 行きたい場所ややりたいことを一緒に楽しむ生活にしたい"
      },

      // お金・家計 MO (S vs P) : A=Saver, B=Player
      {
        id: 5,
        axis: "MO",
        direction: +1,
        text: "お金の使い方で、より自分らしいのはどちらですか？",
        aLabel: "A. まずは貯蓄や将来の安心を確保したい",
        bLabel: "B. 今の経験や楽しみのためにも、ある程度使いたい"
      },
      {
        id: 6,
        axis: "MO",
        direction: +1,
        text: "ボーナスが入ったときのイメージとして近いのは？",
        aLabel: "A. 基本は貯金や将来のために回したい",
        bLabel: "B. 旅行やご褒美など、記憶に残る使い方を優先したい"
      },
      {
        id: 7,
        axis: "MO",
        direction: +1,
        text: "結婚後の家計運営について、どちらの方が安心しますか？",
        aLabel: "A. 「貯める」「守る」がベースにある家計スタイル",
        bLabel: "B. 人生の充実や経験のために、ある程度は使っていく家計スタイル"
      },
      {
        id: 8,
        axis: "MO",
        direction: +1,
        text: "クレジットカードの明細を見たときの感覚に近いのは？",
        aLabel: "A. 「もう少し抑えよう」と管理意識が働きやすい",
        bLabel: "B. 「まあなんとかなる」と楽観的に捉えることが多い"
      },

      // 愛情表現 LX (N vs V) : A=Nurture, B=Verbal
      {
        id: 9,
        axis: "LX",
        direction: +1,
        text: "パートナーに「好き」を伝えるとき、まず浮かぶのは？",
        aLabel: "A. 一緒に過ごす時間を増やしたり、何かしてあげること",
        bLabel: "B. メッセージや言葉で、気持ちをきちんと伝えること"
      },
      {
        id: 10,
        axis: "LX",
        direction: +1,
        text: "相手からの愛情表現として、一番うれしいのは？",
        aLabel: "A. 手伝ってくれる・支えてくれるなど、行動で示されること",
        bLabel: "B. 「ありがとう」「好きだよ」など、言葉で伝えてくれること"
      },
      {
        id: 11,
        axis: "LX",
        direction: +1,
        text: "日常の連絡スタイルとして近いのは？",
        aLabel: "A. 用事があるときや会うときにしっかり時間を取れれば十分",
        bLabel: "B. 特に用事がなくても、ちょっとしたメッセージを送りたい"
      },
      {
        id: 12,
        axis: "LX",
        direction: +1,
        text: "記念日や特別な日のイメージは？",
        aLabel: "A. 手料理や一緒に過ごす時間など、行動で特別感を出したい",
        bLabel: "B. メッセージカードや言葉で気持ちをしっかり伝えたい"
      },

      // 衝突 CF (D vs R) : A=Direct, B=Round
      {
        id: 13,
        axis: "CF",
        direction: +1,
        text: "パートナーとの間でモヤモヤを感じたとき、どちらが多いですか？",
        aLabel: "A. できるだけ早めに話しておきたい",
        bLabel: "B. しばらく様子を見て、落ち着いてから話したい"
      },
      {
        id: 14,
        axis: "CF",
        direction: +1,
        text: "ケンカや衝突について、どちらの考えが近いですか？",
        aLabel: "A. ぶつかってもいいから、話して解決したい",
        bLabel: "B. なるべく大きな衝突は避けたい"
      },
      {
        id: 15,
        axis: "CF",
        direction: +1,
        text: "相手が怒っていそうなとき、あなたはどうしがちですか？",
        aLabel: "A. 状況を確認して、話せそうなら早めに話したい",
        bLabel: "B. とりあえずそっとしておき、タイミングを見たい"
      },
      {
        id: 16,
        axis: "CF",
        direction: +1,
        text: "「ごめんね」を伝えるタイミングとして近いのは？",
        aLabel: "A. 気づいたらすぐに伝えたい方だ",
        bLabel: "B. 相手が落ち着いてから、タイミングを見て伝えたい"
      }
    ];

    // ===============================
    // 16タイプ定義
    // ===============================
    const TYPE_PROFILES = {
      "HSND": {
        name: "家守り番長",
        catch: "安定した暮らしを作り、行動で支え、必要なときはちゃんと話す。",
        life: "家でのんびり過ごす時間と、堅実な家計運営を大切にするタイプ。派手さよりも、毎日の生活が整っていることに安心を感じます。",
        partner: "パートナーのために動いたり、家事や段取りを引き受けることが多め。モヤモヤがあればその場で話し合い、関係をきちんと整えたいと考えます。",
        strengths: [
          "結婚生活の土台を安定させるのが得意",
          "具体的な行動で相手を支えられる",
          "問題を放置せず、話し合いで解決しようとする",
          "堅実な家計で将来への不安を減らせる"
        ],
        weaknesses: [
          "慎重になりすぎて、楽しみのための出費にブレーキをかけがち",
          "自分が動きすぎて、気づくと負担が偏っていることも",
          "率直さが強く出ると、相手が責められているように感じることがある"
        ]
      },

      "HSNR": {
        name: "おだやか家計マネージャー",
        catch: "静かな安定感と、衝突を避ける優しさで家を守る。",
        life: "落ち着いた暮らしと堅実な家計を好み、大きな波の少ない生活に安心を感じるタイプ。計画的で、日常を淡々と回すことが得意です。",
        partner: "行動や時間で愛情を示しつつ、ケンカはできるだけ穏やかに済ませたいスタイル。話し合いは必要だと分かりつつも、一度クールダウンしてから向き合いたいと考えます。",
        strengths: [
          "家計や生活のリスク管理が上手い",
          "相手にとって「ほっとできる存在」になりやすい",
          "衝突を大きくしない配慮ができる",
          "コツコツとした積み上げが得意"
        ],
        weaknesses: [
          "我慢をため込んでしまい、ある日一気に疲れが出ることがある",
          "問題を先送りしすぎると、小さな不満がたまるリスク",
          "自分の頑張りや不満を言葉にするのが後回しになりがち"
        ]
      },

      "HSVD": {
        name: "言葉巧みな家庭ナビゲーター",
        catch: "堅実な暮らしをベースに、言葉と話し合いで舵を取る。",
        life: "家での時間や安定した暮らしを大事にしつつ、無理のない範囲で貯蓄や将来設計を進めていくタイプ。生活のバランス感覚に優れています。",
        partner: "「ありがとう」「こうしたい」をきちんと伝えながら、話し合いで関係を整えるスタイル。感情を放置せず、言葉で橋をかけていきます。",
        strengths: [
          "パートナーにとって分かりやすいコミュニケーションができる",
          "家計・生活・気持ちのバランスをとるのが上手い",
          "問題が起きてもすり合わせながら解決できる",
          "相手の不安に言葉で寄り添える"
        ],
        weaknesses: [
          "言葉での説明が増えすぎると、相手が疲れてしまうことも",
          "慎重さゆえに、大きなチャレンジに踏み出すのが遅くなりがち",
          "自分の行動面での負担が後回しになることがある"
        ]
      },

      "HSVR": {
        name: "やさしめ家庭パートナー",
        catch: "安定志向×言葉の気遣い×空気を読む穏やかさ。",
        life: "安定感のある暮らしと、堅実な家計運営をベースに、静かな日常を丁寧に積み上げていくタイプ。急激な変化よりも、着実なステップを好みます。",
        partner: "衝突よりも調和を大事にしつつ、言葉で相手を思いやるスタイル。小さな「ありがとう」やねぎらいの一言を大切にします。",
        strengths: [
          "一緒にいると心が落ち着く存在になりやすい",
          "相手に配慮した優しいコミュニケーションができる",
          "家計や生活の基盤づくりに向いている",
          "大きな波風を立てずに関係を続けやすい"
        ],
        weaknesses: [
          "自分の本音を飲み込んでしまうことがある",
          "変化を避けすぎると、関係がマンネリ化しやすい",
          "本当はつらいのに「大丈夫」と言ってしまいがち"
        ]
      },

      "HPND": {
        name: "おうち満喫職人",
        catch: "家は落ち着きたい、でも楽しみにはお金も時間も使いたい。",
        life: "ベースは家で落ち着きたいけれど、趣味や楽しみにもしっかり投資したいタイプ。オン・オフの切り替えがはっきりしていることが多いです。",
        partner: "一緒に過ごす時間や家事・サポートなど、行動で支えるスタイル。必要なときにははっきり話し合い、現実的に物事を進めていきます。",
        strengths: [
          "生活の安定と楽しみを両立させやすい",
          "パートナーの具体的な負担を減らせる",
          "決めるべき場面で腰が重くなりにくい",
          "計画さえ立てれば、堅実さと柔軟さのバランスが良い"
        ],
        weaknesses: [
          "気づくと支出がやや多くなりがち",
          "相手が超堅実派だとペース調整が必要",
          "自分が動けてしまう分、「やってもらう」ことが苦手になることも"
        ]
      },

      "HPNR": {
        name: "ゆるっと家族サポーター",
        catch: "家でまったり＋たまに贅沢。空気を読みながら支える。",
        life: "基本はおうち時間が好きで、日常はゆったりめ。ただし、ここぞというときには楽しいことにお金をかけたいタイプです。",
        partner: "行動や時間で相手を支えつつ、争いは避けたいスタイル。多少のモヤモヤは様子を見ながら、自分の中で折り合いをつけることも多いです。",
        strengths: [
          "一緒にいてラクだと感じてもらいやすい",
          "プレッシャーをかけずに相手を支えられる",
          "日常の小さな幸せを見つけるのが上手い",
          "多少のブレがあっても柔軟に受け止められる"
        ],
        weaknesses: [
          "家計管理がざっくりになりやすい",
          "不満をため込んでしまうと、後からドッと疲れが出ることも",
          "重要な話し合いを先延ばしにしがち"
        ]
      },

      "HPVD": {
        name: "甘やかし上手なホーム演出家",
        catch: "家はくつろぎのテーマパーク。言葉と行動で盛り上げるリーダー。",
        life: "家での時間を大事にしつつ、イベントやご褒美にはしっかり投資するタイプ。記念日や季節ごとの楽しみ方を考えるのが得意です。",
        partner: "「ありがとう」「好き」を言葉で伝えながら、必要な話し合いもこなすスタイル。場の空気を明るくしつつ、決めるところは決められます。",
        strengths: [
          "一緒にいて飽きない家庭づくりができる",
          "愛情表現が分かりやすく、安心感につながりやすい",
          "イベントや記念日を上手に演出できる",
          "問題があってもコミュニケーションで乗り越えやすい"
        ],
        weaknesses: [
          "楽しみ優先で支出が増えやすい",
          "相手がシンプル派だと「ちょっと重い」と感じられることも",
          "自分ばかり動いて疲れてしまうリスク"
        ]
      },

      "HPVR": {
        name: "やわらかご褒美隊長",
        catch: "おうちベースで、たまにご褒美。穏やかな甘やかし担当。",
        life: "日常は落ち着いたペースで、時々のご褒美や楽しみにお金をかけたいタイプ。無理はしないけれど、人生をちゃんと楽しみたい感覚があります。",
        partner: "言葉でねぎらい・感謝を伝えながら、衝突はできるだけ穏やかに済ませたいスタイル。雰囲気を壊さないコミュニケーションを好みます。",
        strengths: [
          "やわらかい雰囲気でパートナーを包み込みやすい",
          "頑張りをちゃんと言葉で認められる",
          "小さな贅沢を一緒に楽しむのがうまい",
          "衝突を必要以上に大きくしない"
        ],
        weaknesses: [
          "お金の使い方が場当たり的になりやすい",
          "本音を飲み込みすぎると、どこかでバランスを崩しやすい",
          "重要なテーマの話し合いを避けてしまうことがある"
        ]
      },

      "ASND": {
        name: "堅実アクティブプランナー",
        catch: "人生をちゃんと楽しみたいからこそ、計画と話し合いを大事にする。",
        life: "外出や新しい体験は好きだけれど、家計や将来設計はしっかりしておきたいタイプ。メリハリのあるライフプランを考えるのが得意です。",
        partner: "一緒に動き、一緒に楽しむ行動派。必要な場面ではしっかり話し合い、現実的な落としどころを探します。",
        strengths: [
          "計画性と行動力のバランスが良い",
          "二人の将来像を具体的に描きやすい",
          "課題があっても逃げずに向き合える",
          "楽しみも我慢も、必要に応じて調整できる"
        ],
        weaknesses: [
          "頭の中が常に「計画モード」になりすぎることがある",
          "相手がのんびりタイプだと、少し急かしてしまうことも",
          "自分の弱さを見せるのが少し苦手"
        ]
      },

      "ASNR": {
        name: "やさしい遠足仕掛人",
        catch: "外ではアクティブ、中ではおだやか。堅実さベースのやわらかパートナー。",
        life: "休日は外出やアクティビティも楽しみたいけれど、家計はきちんと管理しておきたいタイプ。堅実さと遊び心を両立しようとします。",
        partner: "行動や時間で愛情を示しつつ、衝突はできるだけ避けたいスタイル。相手のペースにも気を配りながら、一緒に楽しめる形を探します。",
        strengths: [
          "安心感と楽しさの両方を提供しやすい",
          "パートナーの希望に寄り添う余裕がある",
          "堅実さがベースにあるので無茶はしにくい",
          "アクティビティを通じて距離を縮めやすい"
        ],
        weaknesses: [
          "自分の希望を後回しにしてしまうことがある",
          "本当は話したい不満を飲み込むクセがつきがち",
          "予定を詰め込みすぎると、知らないうちに疲れが溜まる"
        ]
      },

      "ASVD": {
        name: "理詰めのおでかけ指南役",
        catch: "言葉で整理し、行動で動く。頼られがちなアクティブ参謀。",
        life: "あちこち動くことや新しい挑戦が好きですが、ベースは堅実。楽しみもリスクも、頭の中でちゃんと計算するタイプです。",
        partner: "言葉で整理しながら、必要なことを決めていくスタイル。話し合いの場では、自然と“まとめ役”になりやすいかもしれません。",
        strengths: [
          "複雑なことを言葉で整理して伝えられる",
          "行動力がありつつ、大きな失敗は避けやすい",
          "パートナーの不安を言語化してあげられる",
          "二人の将来について建設的な議論ができる"
        ],
        weaknesses: [
          "説明が多くなりすぎると、相手が「論破された」と感じることも",
          "自分の疲れや限界を後回しにしがち",
          "計算しすぎて、一歩目が出るのが遅くなることがある"
        ]
      },

      "ASVR": {
        name: "空気読むおでかけ調整役",
        catch: "楽しく動きつつ、言葉のバランスで場を整える。",
        life: "アクティブに動くことが好きで、人との関わりや会話も多めなタイプ。とはいえ家計は整えておきたいという意識も強めです。",
        partner: "その場の空気を読みながら、言葉でフォローするスタイル。衝突を和らげつつ、なんとなく良い雰囲気に持っていくのが得意です。",
        strengths: [
          "場の空気を和ませるのが上手い",
          "相手の気分を察してフォローしやすい",
          "楽しさと安心感のバランスが取れている",
          "人間関係全般を円滑にしやすい"
        ],
        weaknesses: [
          "本音をぼかしすぎて、自分が何をしたいのか見失うことがある",
          "相手の顔色を見すぎて疲れてしまうことも",
          "ケンカが苦手すぎて、大事な話が後回しになるリスク"
        ]
      },

      "APND": {
        name: "全力おでかけ提案王",
        catch: "一緒に全力で楽しみ、一緒にちゃんと話して進んでいく。",
        life: "新しい体験やイベントが大好きで、人生をフルに楽しみたいタイプ。お金も時間も「使ってなんぼ」と考えるところがあります。",
        partner: "一緒に動き、一緒に笑い、一緒に悩む行動派。問題があればその場で話し合い、スピード感を持って対応しようとします。",
        strengths: [
          "二人の思い出をどんどん増やせる",
          "迷ったときに前に進む決断がしやすい",
          "感情を共有しながら関係を深められる",
          "行動量が多いので、人生の幅が広がりやすい"
        ],
        weaknesses: [
          "家計や体力のどちらかが限界を迎えやすい",
          "ゆっくりペースの相手には少し忙しすぎるかもしれない",
          "走り続けているうちに、自分のケアを忘れがち"
        ]
      },

      "APNR": {
        name: "気まま気分メーカー",
        catch: "その場の楽しさを大事にしつつ、深刻な話は少し苦手。",
        life: "楽しいこと・おもしろそうなことがあれば、とりあえずやってみたいタイプ。細かい計画よりも、その場のノリや直感を重視します。",
        partner: "行動や時間で距離を縮める一方、重い話や衝突はできるだけ避けたいスタイル。明るさで場を和ませるのが得意です。",
        strengths: [
          "一緒にいて退屈しないパートナーになりやすい",
          "場を楽しい方向に持っていくのが得意",
          "小さなことを気にしすぎず、前向きでいられる",
          "思い立ったらすぐ動けるフットワークの軽さ"
        ],
        weaknesses: [
          "家計や将来設計が後回しになりやすい",
          "苦手な話題から逃げがちで、問題が長引くことも",
          "相手に「ちゃんとしてほしい」と思われる場面もある"
        ]
      },

      "APVD": {
        name: "ドラマチックプロデューサー",
        catch: "言葉も行動も全開。恋も結婚も「物語」として楽しむ。",
        life: "イベント・旅行・新しい挑戦など、人生に彩りを求めるタイプ。お金も時間も「経験」に投資することが多いです。",
        partner: "愛情表現は分かりやすく、言葉と行動の両方で示していくスタイル。話し合いも恐れず、二人の物語を一緒に作っていくイメージを持ちます。",
        strengths: [
          "強い印象に残る時間をたくさん作れる",
          "パートナーを「特別扱い」するのが得意",
          "関係性を放置せず、アップデートしていける",
          "人生を共に楽しむ「相棒」を探しやすい"
        ],
        weaknesses: [
          "感情の波が大きくなりやすい",
          "出費がかさみやすく、家計管理の工夫が必須",
          "落ち着いた関係を好む相手には少し激しく感じられることも"
        ]
      },

      "APVR": {
        name: "雰囲気だいじ職人",
        catch: "人生は楽しみたい。でも雰囲気は壊したくない。",
        life: "やりたいこと・行きたい場所は多めで、人生を楽しみたい欲求が強いタイプ。ただし空気を壊すような衝突はあまり好みません。",
        partner: "言葉で気持ちを伝えつつ、場の空気を読みながらコミュニケーションするスタイル。衝突を避けつつ、なんとなく良い方向に持っていこうとします。",
        strengths: [
          "楽しい提案ができて、関係に明るさをもたらしやすい",
          "相手を傷つけない言い回しを選べる",
          "日常の中に小さなイベントを作るのが得意",
          "重くなりすぎない距離感でいられる"
        ],
        weaknesses: [
          "お金とエネルギーの使いすぎには要注意",
          "踏み込んだ話を避けると、関係が表面的になりやすい",
          "本音を言うタイミングを逃してモヤモヤが残ることがある"
        ]
      }
    };

    // 画像パスのベース（例：images/types/HSND.png）
    const TYPE_IMAGE_BASE = "images/types";

    // ===============================
    // 状態管理
    // ===============================
    let currentIndex = 0; // 0-based
    const answers = {};   // questionId -> 0〜5（ハートindex）

    const quizView = document.getElementById("quiz-view");
    const resultView = document.getElementById("result-view");

    const progressTextEl = document.getElementById("progress-text");
    const progressBarEl = document.getElementById("progress-bar");
    const qIndexLabelEl = document.getElementById("question-index-label");
    const qTextEl = document.getElementById("question-text");
    const labelAEl = document.getElementById("label-a");
    const labelBEl = document.getElementById("label-b");
    const heartsRowEl = document.getElementById("hearts-row");
    const prevBtn = document.getElementById("prev-btn");
    const nextBtn = document.getElementById("next-btn");

    const resultTypeNameEl = document.getElementById("result-type-name");
    const resultCodeEl = document.getElementById("result-code");
    const resultCodeInlineEl = document.getElementById("result-code-inline");
    const resultCatchEl = document.getElementById("result-catch");
    const resultLifeEl = document.getElementById("result-life");
    const resultPartnerEl = document.getElementById("result-partner");
    const resultStrengthsEl = document.getElementById("result-strengths");
    const resultWeaknessesEl = document.getElementById("result-weaknesses");
    const axisChipsEl = document.getElementById("axis-chips");
    const restartBtn = document.getElementById("restart-btn");
    const copyUrlBtn = document.getElementById("copy-url-btn");
    const resultImageEl = document.getElementById("result-image");

    const typeListQuizEl = document.getElementById("type-list-quiz");
    const typeListResultEl = document.getElementById("type-list-result");

    // ===============================
    // 質問描画
    // ===============================
    function renderQuestion() {
      const total = QUESTIONS.length;
      const q = QUESTIONS[currentIndex];
      const answeredIndex = answers[q.id];

      progressTextEl.textContent = `質問 ${currentIndex + 1} / ${total}`;
      const progressPercent = (currentIndex / total) * 100;
      progressBarEl.style.width = `${progressPercent}%`;

      qIndexLabelEl.textContent = `Q${String(currentIndex + 1).padStart(2, "0")}`;
      qTextEl.textContent = q.text;
      labelAEl.textContent = q.aLabel;
      labelBEl.textContent = q.bLabel;

      heartsRowEl.innerHTML = "";
      for (let i = 0; i < 6; i++) {
        const btn = document.createElement("button");
        const side = i < 3 ? "A" : "B";
        let sizeClass = "";
        if (i === 1 || i === 4) sizeClass = " medium";
        if (i === 2 || i === 3) sizeClass = " small";

        btn.className = "heart-btn" + sizeClass;
        btn.dataset.value = String(i);
        btn.dataset.side = side;
        btn.innerHTML = "❤";

        if (answeredIndex === i) {
          btn.classList.add("selected");
        }
        btn.addEventListener("click", () => {
          answers[q.id] = i;
          renderQuestion();
        });
        heartsRowEl.appendChild(btn);
      }

      prevBtn.disabled = currentIndex === 0;
      nextBtn.disabled = answers[q.id] == null;
      if (currentIndex === total - 1) {
        nextBtn.textContent = "結果を見る →";
      } else {
        nextBtn.textContent = "次へ →";
      }
    }

    function clearUrlType() {
      const url = new URL(window.location.href);
      url.searchParams.delete("type");
      history.replaceState(null, "", url.toString());
    }

    function resetQuiz() {
      clearUrlType();
      Object.keys(answers).forEach(key => delete answers[key]);
      currentIndex = 0;
      quizView.style.display = "";
      resultView.style.display = "none";
      renderQuestion();
      renderTypeList(null); // 一覧はハイライトなしで維持
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // ===============================
    // 全16タイプ一覧描画（Quiz & Result 両方）
    // ===============================
    function renderTypeList(activeCode) {
      function fillList(targetEl) {
        if (!targetEl) return;
        targetEl.innerHTML = "";

        for (const [code, profile] of Object.entries(TYPE_PROFILES)) {
          const item = document.createElement("button");
          item.type = "button";
          item.className = "type-list-item" + (code === activeCode ? " is-active" : "");
          item.dataset.code = code;

          // 画像＋テキストの横並びコンテナ
          const content = document.createElement("div");
          content.className = "type-list-item-content";

          const thumb = document.createElement("img");
          thumb.className = "type-list-thumb";
          thumb.src = `${TYPE_IMAGE_BASE}/${code}.png`;
          thumb.alt = `${profile.name}のアイコン`;
          thumb.loading = "lazy";

          const textBox = document.createElement("div");
          textBox.className = "type-list-text";

          const codeEl = document.createElement("div");
          codeEl.className = "type-list-code";
          codeEl.textContent = code;

          const nameEl = document.createElement("div");
          nameEl.className = "type-list-name";
          nameEl.textContent = profile.name;

          const catchEl = document.createElement("div");
          catchEl.className = "type-list-catch";
          catchEl.textContent = profile.catch;

          textBox.appendChild(codeEl);
          textBox.appendChild(nameEl);
          textBox.appendChild(catchEl);

          content.appendChild(thumb);
          content.appendChild(textBox);
          item.appendChild(content);

          item.addEventListener("click", () => {
            const chosenSides = [];
            for (let i = 0; i < AXES.length; i++) {
              const axisDef = AXES[i];
              const letter = code[i];
              let side;
              if (axisDef.sideA.code === letter) side = axisDef.sideA;
              else if (axisDef.sideB.code === letter) side = axisDef.sideB;
              else return;
              chosenSides.push({ axis: axisDef, side });
            }
            renderResult(code, chosenSides);
          });

          targetEl.appendChild(item);
        }
      }

      fillList(typeListQuizEl);
      fillList(typeListResultEl);
    }

    // ===============================
    // 結果計算（4軸 → 4文字コード → TYPE_PROFILES）
    // ===============================
    function calculateResult() {
      const axisScores = {};
      AXES.forEach(a => {
        axisScores[a.key] = 0;
      });

      for (const q of QUESTIONS) {
        const idx = answers[q.id];
        if (idx == null) continue;
        const base = HEART_VALUES[idx]; // A寄りが +3〜+1, B寄りが -1〜-3
        axisScores[q.axis] += base * q.direction;
      }

      const chosenSides = [];
      const codeLetters = [];

      for (const axisDef of AXES) {
        const score = axisScores[axisDef.key] || 0;
        const side = score >= 0 ? axisDef.sideA : axisDef.sideB;
        chosenSides.push({ axis: axisDef, side });
        codeLetters.push(side.code);
      }

      const code = codeLetters.join("");
      renderResult(code, chosenSides);
    }

    function updateUrlWithCode(code) {
      const url = new URL(window.location.href);
      url.searchParams.set("type", code);
      history.replaceState(null, "", url.toString());
    }

    function renderResult(code, chosenSides) {
      const profile = TYPE_PROFILES[code];

      updateUrlWithCode(code);

      quizView.style.display = "none";
      resultView.style.display = "";

      if (!profile) {
        resultTypeNameEl.textContent = "不明なタイプ";
        resultCodeEl.textContent = code;
        resultCodeInlineEl.textContent = code;
        resultCatchEl.textContent = "タイプ定義が見つかりませんでした。設定を確認してください。";
        resultLifeEl.textContent = "";
        resultPartnerEl.textContent = "";
        resultStrengthsEl.innerHTML = "";
        resultWeaknessesEl.innerHTML = "";
        axisChipsEl.innerHTML = "";
        if (resultImageEl) {
          resultImageEl.src = `${TYPE_IMAGE_BASE}/default.png`;
          resultImageEl.alt = "タイプイメージ";
        }
        renderTypeList(code);
        return;
      }

      resultTypeNameEl.textContent = profile.name;
      resultCodeEl.textContent = code;
      resultCodeInlineEl.textContent = code;
      resultCatchEl.textContent = profile.catch;

      // 画像パスをコードから生成（images/types/HSND.png など）
      if (resultImageEl) {
        resultImageEl.src = `${TYPE_IMAGE_BASE}/${code}.png`;
        resultImageEl.alt = `${profile.name}のイメージ`;
      }

      axisChipsEl.innerHTML = "";
      chosenSides.forEach(cs => {
        const chip = document.createElement("span");
        chip.className = "axis-chip";
        chip.textContent = `${cs.axis.name}：${cs.side.label}`;
        axisChipsEl.appendChild(chip);
      });

      resultLifeEl.textContent = profile.life;
      resultPartnerEl.textContent = profile.partner;

      resultStrengthsEl.innerHTML = "";
      (profile.strengths || []).forEach(s => {
        const li = document.createElement("li");
        li.textContent = s;
        resultStrengthsEl.appendChild(li);
      });

      resultWeaknessesEl.innerHTML = "";
      (profile.weaknesses || []).forEach(w => {
        const li = document.createElement("li");
        li.textContent = w;
        resultWeaknessesEl.appendChild(li);
      });

      // 一覧にハイライト反映
      renderTypeList(code);

      window.scrollTo({
        top: resultView.offsetTop - 24,
        behavior: "smooth"
      });
    }

    // ===============================
    // イベントハンドラ
    // ===============================
    prevBtn.addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        renderQuestion();
      }
    });

    nextBtn.addEventListener("click", () => {
      const total = QUESTIONS.length;
      if (currentIndex < total - 1) {
        currentIndex++;
        renderQuestion();
      } else {
        for (const q of QUESTIONS) {
          if (answers[q.id] == null) {
            alert("すべての質問に回答してください。");
            return;
          }
        }
        calculateResult();
      }
    });

    restartBtn.addEventListener("click", resetQuiz);

    copyUrlBtn.addEventListener("click", () => {
      const url = new URL(window.location.href);
      const currentCode = resultCodeEl.textContent.trim();
      if (currentCode && !url.searchParams.get("type")) {
        url.searchParams.set("type", currentCode);
      }
      const shareUrl = url.toString();

      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(shareUrl)
          .then(() => {
            alert("この診断結果のURLをコピーしました。");
          })
          .catch(() => {
            alert("URLのコピーに失敗しました。手動でコピーしてください。");
          });
      } else {
        window.prompt("このURLをコピーしてください。", shareUrl);
      }
    });

    // ===============================
    // 初期表示 & URLからの結果復元
    // ===============================
    function initFromUrl() {
      // 一覧は常に表示
      renderTypeList(null);

      const params = new URLSearchParams(window.location.search);
      const presetCode = params.get("type");
      if (!presetCode) {
        renderQuestion();
        return;
      }

      const profile = TYPE_PROFILES[presetCode];
      if (!profile || presetCode.length !== AXES.length) {
        renderQuestion();
        return;
      }

      const chosenSides = [];
      for (let i = 0; i < AXES.length; i++) {
        const axisDef = AXES[i];
        const letter = presetCode[i];
        let side;
        if (axisDef.sideA.code === letter) side = axisDef.sideA;
        else if (axisDef.sideB.code === letter) side = axisDef.sideB;
        else { renderQuestion(); return; }
        chosenSides.push({ axis: axisDef, side });
      }
      renderResult(presetCode, chosenSides);
    }

    initFromUrl();
  </script>
</body>
</html>
